<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Finalizar Compra</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="site-header">
    <div class="brand"><span class="logo-accent">Tecno</span>PUD <span class="link">LINK</span></div>
    <a href="index.html" class="btn-ghost">üè† Home</a>
  </header>

  <main class="checkout-main">
    <section class="cart-section">
      <h2>Seu Carrinho</h2>
      <div id="cartItems"></div>
      <div class="cart-summary">
        <strong>Total: R$ <span id="cartTotal">0.00</span></strong>
      </div>
    </section>

    <section class="form-section">
      <h2>Dados do Cliente</h2>
      <form id="checkoutForm">
        <label>Nome completo<input name="name" required /></label>
        <label>Email<input name="email" type="email" required /></label>
        <label>Telefone<input name="phone" required /></label>
        <label>Endere√ßo<textarea name="address" rows="2" required></textarea></label>

        <h3>Forma de Pagamento</h3>
        <label><input type="radio" name="pay" value="pix" required /> PIX</label>
        <label><input type="radio" name="pay" value="cartao" /> Cart√£o</label>

        <div id="pixBox" class="pay-box" hidden>
          <p>Escaneie o QR Code para pagar:</p>
          <img src="imagens/qrcode-pix.png" alt="QR Code PIX" class="qrcode"/>
        </div>

        <div id="cardBox" class="pay-box" hidden>
          <label>N√∫mero do Cart√£o<input name="card" required /></label>
          <label>Validade<input name="validade" placeholder="MM/AA" required /></label>
          <label>CVV<input name="cvv" required /></label>
          <label>Parcelamento
            <select name="parcelas">
              <option>√Ä vista</option>
              <option>2x sem juros</option>
              <option>3x sem juros</option>
              <option>6x</option>
            </select>
          </label>
        </div>

        <button type="submit" class="btn-gold">Finalizar Compra</button>
      </form>
      <div id="orderSuccess" class="order-success" hidden>
        <h3>Compra finalizada!</h3>
        <p>Obrigado ‚Äî seus dados foram recebidos.</p>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="footer-grid">
      <div>
        <h4>Contato</h4>
        <p>email@tecnopud.link</p>
        <p>(00) 0000-0000</p>
      </div>
      <div>
        <h4>Sobre n√≥s</h4>
        <p>Especialistas em tecnologia de ponta desde 2025.</p>
      </div>
      <div>
        <h4>Mapa</h4>
        <div class="map-wrap">
          <iframe src="http://googleusercontent.com/maps/place/Rua+Jo√£o+de+Brito+91"></iframe>
        </div>
      </div>
    </div>
    <div class="copyright">TECNOPUD SINCE 2025</div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Fun√ß√µes de manipula√ß√£o do carrinho
        const getCart = () => JSON.parse(localStorage.getItem('cart')) || {};
        const saveCart = (cart) => localStorage.setItem('cart', JSON.stringify(cart));
        
        const cartContainer = document.getElementById('cartItems');
        const cartTotalElement = document.getElementById('cartTotal');
    
        // Fun√ß√£o para renderizar os itens do carrinho
        const renderCart = () => {
            const cart = getCart();
            cartContainer.innerHTML = '';
            let total = 0;
    
            // Se o carrinho estiver vazio, exibe uma mensagem
            if (Object.keys(cart).length === 0) {
                cartContainer.innerHTML = '<p>Seu carrinho est√° vazio.</p>';
                cartTotalElement.textContent = '0.00';
                return;
            }
    
            // Itera sobre cada item do carrinho para criar a exibi√ß√£o
            for (const itemId in cart) {
                const item = cart[itemId];
                const itemPrice = parseFloat(item.price); // Usa o pre√ßo salvo no localStorage
                const itemTotal = itemPrice * item.quantity;
                total += itemTotal;
    
                const itemElement = document.createElement('div');
                itemElement.classList.add('cart-item');
                itemElement.innerHTML = `
                    <div class="item-info">
                        <h4>${item.name}</h4>
                        <p>Pre√ßo: R$ ${itemPrice.toFixed(2)}</p>
                        <p>Quantidade: <span class="quantity-display">${item.quantity}</span></p>
                    </div>
                    <div class="item-actions">
                        <button class="quantity-btn minus-btn" data-id="${itemId}">-</button>
                        <button class="quantity-btn plus-btn" data-id="${itemId}">+</button>
                        <button class="remove-btn" data-id="${itemId}">Remover</button>
                    </div>
                `;
                cartContainer.appendChild(itemElement);
            }
    
            cartTotalElement.textContent = total.toFixed(2);
        };
    
        // Fun√ß√£o para lidar com o clique nos bot√µes de quantidade e remover
        const handleCartActions = (e) => {
            const target = e.target;
            if (target.classList.contains('quantity-btn') || target.classList.contains('remove-btn')) {
                const itemId = target.dataset.id;
                let cart = getCart();
    
                if (target.classList.contains('plus-btn')) {
                    cart[itemId].quantity += 1;
                } else if (target.classList.contains('minus-btn')) {
                    if (cart[itemId].quantity > 1) {
                        cart[itemId].quantity -= 1;
                    }
                } else if (target.classList.contains('remove-btn')) {
                    delete cart[itemId];
                }
                saveCart(cart);
                renderCart(); // Renderiza o carrinho novamente com as altera√ß√µes
            }
        };
    
        // Lida com a sele√ß√£o da forma de pagamento
        const radios = document.querySelectorAll("input[name=pay]");
        radios.forEach(r => r.addEventListener("change", () => {
            document.getElementById("pixBox").hidden = r.value !== "pix";
            document.getElementById("cardBox").hidden = r.value !== "cartao";
        }));
    
        // Lida com a finaliza√ß√£o do pedido
        document.getElementById("checkoutForm").onsubmit = e => {
            e.preventDefault();
            
            // Simula√ß√£o de sucesso do pedido
            const cart = getCart();
            if (Object.keys(cart).length === 0) {
                alert('Seu carrinho est√° vazio. Adicione itens antes de finalizar a compra.');
                return;
            }
    
            document.getElementById("orderSuccess").hidden = false;
            
            // Limpa o carrinho ap√≥s a finaliza√ß√£o
            localStorage.removeItem('cart');
            renderCart();
        };
    
        // Adiciona o listener para os bot√µes do carrinho
        cartContainer.addEventListener('click', handleCartActions);
        
        // Renderiza o carrinho na primeira vez que a p√°gina √© carregada
        renderCart();
    });
  </script>
</body>
</html>
